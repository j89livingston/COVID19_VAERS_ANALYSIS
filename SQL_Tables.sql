-- used clean_vaers_data.csv do import into VAERSData Table

CREATE TABLE VAERSData (
	VAERS_ID VARCHAR(7),
	RECVDATE DATE,
	STATE VARCHAR(2),
	AGE_YRS FLOAT(2),
	SEX VARCHAR(1),
	DIED VARCHAR(1),
	L_THREAT VARCHAR(1),
	ER_VISIT VARCHAR(1),
	HOSPITAL VARCHAR(1),
	HOSPDAYS INT,
	X_STAY VARCHAR(1),
	DISABLE VARCHAR(1),
	RECOVD VARCHAR(1),
	BIRTH_DEFECT VARCHAR(1),
	PRIMARY KEY (VAERS_ID)
);

DROP TABLE VAERSData;
DROP TABLE VAERS_VAX_Symptoms;

-- used VAERS_VAX_Symptoms.csv do import into VAERS_VAX_Symptoms Table

CREATE TABLE VAERS_VAX_Symptoms (
	VAERS_ID INT,
	VAX_TYPE VARCHAR(15),
	VAX_MANU VARCHAR(40),
	VAX_NAME VARCHAR(100),
	SYMPTOM1 VARCHAR(1000),
	SYMPTOM2 VARCHAR(1000),
	SYMPTOM3 VARCHAR(1000),
	SYMPTOM4 VARCHAR(1000),
	SYMPTOM5 VARCHAR(1000),
	PRIMARY KEY (VAERS_ID)
);

SELECT * FROM VAERS_VAX_Symptoms
LIMIT 10;

SELECT  RECVDATE, STATE, AGE_YRS, SEX, DIED, L_THREAT, ER_VISIT, HOSPITAL, HOSPDAYS, X_STAY, DISABLE, RECOVD, BIRTH_DEFECT
   FROM VAERS_VAX_Symptoms 
   FULL JOIN VAERSData
   ON VAERS_VAX_Symptoms.VAERS_ID = VAERSData.VAERS_ID;

